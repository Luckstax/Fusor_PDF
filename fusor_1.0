import os
import pandas as pd

# Definir o diretório onde os arquivos CSV estão localizados
caminho_dos_csv = input('Digite o caminho dos CSV: ')
caminho_do_excel = input('Digite o caminho do arquivo Excel (incluindo o nome do arquivo e extensão .xlsx): ')

# Verificar se o arquivo Excel já existe
if not caminho_do_excel.lower().endswith('.xlsx'):
	print("O caminho do arquivo Excel deve terminar com '.xlsx'.")
else:
	# Criar um objeto ExcelWriter para escrever múltiplas abas no Excel
	with pd.ExcelWriter(caminho_do_excel, engine='openpyxl') as escritor_excel:
		# Loop por todos os arquivos na pasta
		for arquivo in os.listdir(caminho_dos_csv):
			# Verificar se o arquivo tem extensão .csv
			if arquivo.endswith('.csv'):
				# Criar o caminho completo do arquivo
				caminho_do_arquivo = os.path.join(caminho_dos_csv, arquivo)

				# Tentar ler o CSV com a codificação correta e delimitador adequado
				try:
					# Ajuste o delimitador de acordo com o seu CSV (ex: ',' ou ';')
					df = pd.read_csv(caminho_do_arquivo, encoding='ISO-8859-1', delimiter=';')

					# Nome da aba será o nome do arquivo (sem extensão)
					nome_da_aba = os.path.splitext(arquivo)[0]

					# Escrever o DataFrame em uma nova aba no Excel
					df.to_excel(escritor_excel, sheet_name=nome_da_aba, index=False)
				except Exception as e:
					print(f"Erro ao processar o arquivo {arquivo}: {e}")

	print(f"Os arquivos CSV foram importados para diferentes abas no Excel: {caminho_do_excel}")
